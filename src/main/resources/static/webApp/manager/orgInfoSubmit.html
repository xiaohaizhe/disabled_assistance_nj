<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="../../layui/css/layui.css" media="all">
	<link rel="stylesheet" href="../../css/init.css">
	<link rel="stylesheet" href="../../css/search_form.css">
	<style>

	</style>
</head>
<body>

<div class="search-box">
	<form class="layui-form">
		<div class="layui-form-item layui-tab-title">
			<div class="layui-inline" style="padding:0 10px;">
				机构信息填报
			</div>
		</div>
	</form>
</div>

<form class="layui-form" action="">
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">机构名称</label>
			<div class="layui-input-inline">
				<input type="text" name="name" required  lay-verify="required" placeholder="请输入机构名称" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">登记注册时间</label>
			<div class="layui-input-inline">
				<input type="text" name="registrationTime" class="layui-input"  placeholder="请选择时间">
			</div>
		</div>
	</div>


	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">注册证书编号
			</label>
			<div class="layui-input-inline">
				<input type="text" name="registrationCertificateNumber" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">注册部门</label>
			<div class="layui-input-inline">
				<input type="text" name="registrationDepartment" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">机构性质</label>
			<div class="layui-input-inline">
				<input type="text" name="nature" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">房屋产权性质</label>
			<div class="layui-input-inline">
				<select id="fwcqxz" name="natureOfHousingPropertyRightId" lay-verify="required">
				</select>
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">机构面积</label>
			<div class="layui-input-inline">
				<input type="text" name="area" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">床位数</label>
			<div class="layui-input-inline">
				<input type="text" name="bedNum" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">庇护性劳动项目</label>
			<div class="layui-input-inline">
				<input type="text" name="asylumLaborProjects" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<label class="layui-form-label">地址</label>
		<div class="layui-input-inline">
			<select id="province_sele" name="province" lay-verify="required">
				<option value="">省/自治区/直辖市</option>
			</select>
		</div>
		<div class="layui-input-inline">
			<select id="city_sele" name="city" lay-verify="required">
				<option value="南京市">南京市</option>
			</select>
		</div>
		<div class="layui-input-inline">
			<select id="cdistinct_sele" name="distinct" lay-verify="required">
				<option value="雨花台区">区/县</option>
			</select>
		</div>
		<div class="layui-input-inline">
			<select id="" name="block" lay-verify="required">
				<option value="xx街道">街道</option>
			</select>
		</div>

	</div>

	<div class="layui-form-item" style="padding-left:50px;">
		<div class="layui-input-inline">
			<textarea name="detailedAddress" placeholder="详细地址" class="layui-textarea"></textarea>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">负责人</label>
			<div class="layui-input-inline">
				<input type="text" name="personInCharge" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">性别</label>
			<div class="layui-input-inline">
				<input type="text" name="gender" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">出生年月</label>
			<div class="layui-input-inline">
				<input type="text" name="birthMonth" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">文化程度</label>
			<div class="layui-input-inline">
				<input type="text" name="education" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>
	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">联系电话</label>
			<div class="layui-input-inline">
				<input type="text" name="contactNumber" required  lay-verify="required" autocomplete="off" class="layui-input">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">营业执照或登记证书</label>
			<div class="layui-input-inline">
				<button type="button" class="layui-btn" id="test1">
					<i class="layui-icon">&#xe67c;</i>选择文件
				</button>
				<input id="yyzzhdjzs" type="text" name="certification" required  lay-verify="required" autocomplete="off" class="layui-input" style="display:none;">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">银行开户许可证</label>
			<div class="layui-input-inline">
				<button type="button" class="layui-btn" id="test2">
					<i class="layui-icon">&#xe67c;</i>选择文件
				</button>
				<input id="yhkhxkz" type="text" name="openBankAccountPermitCertificate" required  lay-verify="required" autocomplete="off" class="layui-input" style="display:none;">

			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">门头及室内功能区域、无障碍设施</label>
			<div class="layui-input-inline">
				<button type="button" class="layui-btn" id="test3">
					<i class="layui-icon">&#xe67c;</i>选择文件
				</button>
				<input id="mtjslgnjy" type="text" name="facilitiesPictures" required  lay-verify="required" autocomplete="off" class="layui-input" style="display:none;">
			</div>
		</div>
	</div>

	<div class="layui-form-item">
		<div class="layui-inline">
			<label class="layui-form-label">专职工作人员名单</label>
			<div class="layui-input-inline">
				<button type="button" class="layui-btn" id="test4">
					<i class="layui-icon">&#xe67c;</i>选择文件
				</button>
				<input id="zzgzrymd" type="text" name="staffList" required  lay-verify="required" autocomplete="off" class="layui-input" style="display:none;">
			</div>
		</div>
		<div class="layui-inline">
			<label class="layui-form-label">管理制度
			</label>
			<div class="layui-input-inline">
				<button type="button" class="layui-btn" id="test5">
					<i class="layui-icon">&#xe67c;</i>选择文件
				</button>
				<input id="glzd" type="text" name="managementSystem" required  lay-verify="required" autocomplete="off" class="layui-input" style="display:none;">
			</div>
		</div>
	</div>



	<div class="layui-form-item">
		<div class="layui-input-block">
			<button class="layui-btn" lay-submit lay-filter="formDemo">提交</button>
			<button type="reset" class="layui-btn layui-btn-primary">重置</button>
		</div>
	</div>
</form>


<script src="../../js/jquery.min.js"></script>
<script src="../../js/address.js"></script>
<script src="../../layui/layui.js"></script>
<!--<script src="../../js/heightClient.js"></script>-->


<script>
	layui.use(['laydate','form','upload','layer'], function(){
		var form = layui.form;
		var laydate = layui.laydate;
		var upload = layui.upload;
        var layer = layui.layer;
		var $ = layui.$;

        $.ajax({
            type: "GET",
            url: "/api/typeList",
			data:{name:"housing"},
            success: function (data) {
                setHous(data);
                form.render('select'); //刷新select选择框渲染
            }
        })

		//执行实例
		var uploadInst = upload.render({
			elem: '#test1' //绑定元素
			,url: '/api/file/upload' //上传接口
			,data:{type:"certification"}
			,done: function(res){
			    if(res.data){
                    layer.msg('上传成功');
					$("#yyzzhdjzs").val(res.data.fileUrl)
				}
				//上传完毕回调
			}
			,error: function(){
				//请求异常回调
			}
		});

		var uploadInst2 = upload.render({
			elem: '#test2' //绑定元素
            ,url: '/api/file/upload' //上传接口
            ,data:{type:"openBankAccountPermitCertificate"}
			,done: function(res){
                if(res.data){
                    layer.msg('上传成功');
                    $("#yhkhxkz").val(res.data.fileUrl)
                }
				//上传完毕回调
			}
			,error: function(){
				//请求异常回调
			}
		});

        var uploadInst3 = upload.render({
            elem: '#test3' //绑定元素
            ,url: '/api/file/upload' //上传接口
            ,data:{type:"facilitiesPictures"}
            ,done: function(res){
                if(res.data){
                    layer.msg('上传成功');
                    $("#mtjslgnjy").val(res.data.fileUrl)
                }
                //上传完毕回调
            }
            ,error: function(){
                //请求异常回调
            }
        });

        var uploadInst4 = upload.render({
            elem: '#test4' //绑定元素
            ,url: '/api/file/upload' //上传接口
            ,data:{type:"staffList"}
            ,done: function(res){
                if(res.data){
                    layer.msg('上传成功');
                    $("#zzgzrymd").val(res.data.fileUrl)
                }
                //上传完毕回调
            }
            ,error: function(){
                //请求异常回调
            }
        });

        var uploadInst5 = upload.render({
            elem: '#test5' //绑定元素
            ,url: '/api/file/upload' //上传接口
            ,data:{type:"managementSystem"}
            ,done: function(res){
                if(res.data){
                    layer.msg('上传成功');
                    $("#glzd").val(res.data.fileUrl)
                }
                //上传完毕回调
            }
            ,error: function(){
                //请求异常回调
            }
        });

		//执行一个laydate实例
		laydate.render({
			elem: '#registDate' //指定元素
		});
		//监听提交
		form.on('submit(formDemo)', function(data){
			// layer.msg(JSON.stringify(data.field));
			var _data = data.field;
            delete _data['file'];
			_data.adminId = "1";
            _data.block = "xxx";
            _data.addressId = "ccccccc";
            _data.addressId = "4324";

            $.ajax({
                type: "POST",
                url: "/api/org/saveAndFlush",
                data: JSON.stringify(_data),
                dataType:"json",
                contentType : 'application/json;charset=utf-8',
                processData: false,
                success: function (data) {
                    console.log(data);

                }
            })
			return false;
		});
	});

	function setHous(data) {
	    var array = data.data;
        var html = [];
        for (var i = 0; i < array.length; i++) {
            html.push('<option value="'+array[i].id+'">'+array[i].name+'</option>');
        }
        $("#fwcqxz").html(html.join(""));
    }

	function getAddress(type, name) {
	    var html = [];
        for (var i = 0; i < provinceList.length; i++) {
            if(provinceList[i][type] && !name){
                html.push('<option value="'+provinceList[i].name+'">'+provinceList[i].name+'</option>');
			}else if(provinceList[i].name == name){

			}
        }
        return html.join("");
    }

    $("#province_sele").html(getAddress("cityList", null));

</script>
</body>
</html>